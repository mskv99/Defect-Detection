# Defect-Detection

## Введение 
Область детектирования изображений с использованием глубокого обучения постоянно развивается – появляется множество новых техник и моделей, которые находят применение в промышленном производстве. Одной из таких возможных областей применения является детектирование дефектов в полупроводниковой отрасли. Автоматическое детектирование дефектов позволяет значительно снизить временные/трудовые ресурсы при анализе большого количества снимков (200 и более). Сканирующий электронный микроскоп производит изображения с высоким разрешением в нанометровом масштабе. Шум на SEM-изображениях и постоянное уменьшение тех. процесса приводят к сбою традиционных методов обработки изображений на основе правил для нахождения дефектов. Это вызвало научный интерес к применению алгоритмов машинного обучения, в особенности глубокого обучения, из-за их способности лучше справляться с шумом и изменениями масштаба. Данные методы найдут дальнейшее применение при отборе изображений хорошего качества для проведения калибровки модели фоторезиста.

## Датасет
Для создания датасета использовался набор из 350 SEM-изображений размером 1024x1024 формата ‘.tiff’. Исходный набор был разделён на тренировочную, валидационную и тестовую выборки в соотношении 71:19:9. Исходные изображения были уменьшены до размера 640x640 для оптимальной работы нейронной сети. В процессе анализа имеющихся изображений было выделено 4 типа структур: **SRAF**, **BRIDGE**, **COLLAPSE**, **GAP** .

## Эксперимент
В работе проведён сравнительный анализ моделей одностадийных (**YoloV5** и **RetinaNet**) и двустадийных детекторов(**FasterRCNN**). В силу небольшого размера датасета было решено использовать предобученные на датасете **MSCOCO** (*Microsoft* *Common* *Object* *in* *Context*) модели. Для обучения использовались две предобученные модели из семейства **YoloV5**: **YoloV5s**(*small*), **YoloV5m**(*medium*), которые отличаются количеством параметров. Также отдельно был проведён эксперимент с заморозкой первых 15 слоёв у модели YoloV5m. У моделей Retina и FasterRCNN в качестве базовой сети для извлечения признаков использовалась предобученная модель **ResNet 50 FPN**.  Вначале был проведён эксперимент с работой вышеперечисленных моделей со стандартным набором гиперпараметров.Размер jupyter-ноутбуков слишком большой для просмотра проектов на платформе github, поэтому ниже можно просмотреть проекты  на платформе google colab:

* [Модель YoloV5](https://drive.google.com/file/d/1tWXDTCf9PU91_FQEolvEb5mwBZghlqMA/view?usp=sharing) ;
* [Модель RetinaNet](https://colab.research.google.com/drive/1RE86kC1hvKwxSVpbnZw43GGMJ4eaXm8P?usp=sharing);
* [Модель FasterRCNN](https://colab.research.google.com/drive/1Fp8zvTNBYwg4O5e6dEZuRF2ww6SJeckQ?usp=sharing).
